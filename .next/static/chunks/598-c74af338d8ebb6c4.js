(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[598],{9598:function(e,n,s){"use strict";s.d(n,{Z:function(){return O}});var t=s(5893),r=s(5512),a=s.n(r),i=s(9172),l=s.n(i),c=s(3299),o=s(7294),u=s(4480),d=s(338),_=s(1163),g=s(6502),m=s.n(g),p=s(1664),x=s.n(p),h=s(3033);function j(e){let{setLoginArea:n,setSignupArea:s}=e,r=(0,u.sJ)(d.EA),a=(0,u.Zl)(d.np),[i,l]=(0,o.useState)(""),[_,g]=(0,o.useState)(!1),[p,j]=(0,o.useState)(""),[f,v]=(0,o.useState)(!1),[S,b]=(0,o.useState)(""),N=function(e){e.preventDefault(),g(!0),(0,c.signIn)("credentials",{email:p,password:S,callbackUrl:window.location.href,redirect:!1}).then(async e=>{let{ok:n,error:s}=e,t=await (0,c.getSession)();console.log(t),n&&t?(f&&localStorage.setItem("login",p),a(t.user)):l(s),g(!1)})};return(0,o.useEffect)(()=>{if(r.user_key)return n(!1),!1;localStorage.getItem("login")&&j(localStorage.getItem("login"))},[r]),(0,t.jsxs)("div",{className:m().wrap,children:[(0,t.jsxs)("div",{className:m().inner,children:[(0,t.jsxs)("h1",{className:m().title,children:["JOOTONG 로그인",(0,t.jsx)("button",{className:m().cancel,onClick:()=>{n(!1)}})]}),(0,t.jsxs)("div",{className:m().credential,children:[(0,t.jsxs)("form",{children:[(0,t.jsx)("div",{className:m().email,children:(0,t.jsx)("input",{type:"text",value:p,maxLength:50,onChange:e=>{j(e.target.value)},placeholder:"이메일을 입력해주세요"})}),(0,t.jsx)("div",{className:m().password,children:(0,t.jsx)("input",{type:"password",value:S,maxLength:20,onChange:e=>{b(e.target.value)},required:!0,placeholder:"비밀번호"})}),i&&(0,t.jsx)("div",{className:m().error_message,children:i}),(0,t.jsx)("button",{className:m().login,onClick:e=>{N(e)},children:"로그인"})]}),(0,t.jsxs)("div",{className:m().util_box,children:[(0,t.jsxs)("label",{className:m().agree_label,children:[(0,t.jsx)("input",{type:"checkbox",checked:f,onChange:()=>{v(!f)}}),(0,t.jsx)("span",{children:"아이디 기억"})]}),(0,t.jsx)("button",{className:m().signup,onClick:e=>s(!0),children:"간편 회원가입"}),(0,t.jsx)(x(),{href:"/auth/forgotpassword",className:m().forgot_password,children:"비밀번호 찾기"})]})]}),(0,t.jsxs)("div",{className:m().sns_login,children:[(0,t.jsx)("h1",{children:"SNS 계정 으로 로그인"}),(0,t.jsxs)("div",{className:m().sns_list,children:[(0,t.jsx)("div",{className:m().google_login,children:(0,t.jsx)("button",{className:m().google,onClick:()=>(0,c.signIn)("google",{callbackUrl:window.location.href+"?fromSNS"})})}),(0,t.jsx)("div",{className:m().naver_login,children:(0,t.jsx)("button",{className:m().naver,onClick:()=>(0,c.signIn)("naver",{callbackUrl:window.location.href+"?fromSNS"})})}),(0,t.jsx)("div",{className:m().kakao_login,children:(0,t.jsx)("button",{className:m().kakao,onClick:()=>(0,c.signIn)("kakao",{callbackUrl:window.location.href+"?fromSNS"})})})]})]})]}),_&&(0,t.jsx)("div",{className:m().loading,children:(0,t.jsx)(h.Z,{})})]})}var f=s(1068),v=s.n(f),S=s(5137),b=s(1967);function N(e){let{setSignupArea:n,setAlertData:s}=e,r=(0,u.Zl)(d.np);(0,_.useRouter)();let a=(0,o.useRef)(),i=(0,o.useRef)(),l=(0,o.useRef)(),g=(0,o.useRef)(),[m,p]=(0,o.useState)(!0),[j,f]=(0,o.useState)(""),[N,w]=(0,o.useState)(!1),k=function(e){S.J.test(e.target.value)?(f(""),a.current.value=e.target.value):f("* 올바른 이메일 형식이 아닙니다")},y=function(e){i.current=e.target.value,i.current||l.current?i.current.length<8?f("* 비밀번호는 8글자 이상 입니다."):b.L.test(i.current)?l.current&&i.current!==l.current?f("* 비밀번호를 확인해주세요"):f(""):f("* 비밀번호는 (필수)문자+숫자 조합입니다."):f("")},D=function(e){l.current=e.target.value,i.current.length<8?f("* 비밀번호는 8글자 이상 입니다."):b.L.test(i.current)?i.current!==l.current?f("* 비밀번호를 확인해주세요"):f(""):f("* 비밀번호는 문자+숫자 조합입니다.")},C=function(){if(a.current.value&&l.current&&g.current.checked&&l.current===i.current){w(!0),f("");let e={email:a.current.value,password:i.current,provider:"credential"};fetch("/api/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{e.status?(0,c.signIn)("credentials",{email:e.email,password:i.current,callbackUrl:window.location.href,redirect:!1}).then(async e=>{let{ok:n,error:a}=e,i=await (0,c.getSession)();n&&i?(r(i.user),s({isAlert:!0,message:(0,t.jsxs)("span",{children:["\uD83C\uDF89회원가입을 축하합니다!\uD83D\uDD25\uD83D\uDD25 ",(0,t.jsx)("br",{})," [기념선물지급 - 닉네임변경권] ",(0,t.jsx)("br",{})," 마이페이지에서 사용 가능합니다"]}),confirm:(0,t.jsx)(x(),{href:"/mypage",children:"마이페이지"}),cancel:(0,t.jsx)("button",{onClick:()=>{s({isAlert:!1})},children:"확인"})})):f(a)}):f(e.code||e.message||"일시적인 에러, 다시 시도해 주세요."),w(!1)})}else a.current.value?i.current===l.current&&i.current?g.current.checked||f("* 이용약관에 동의해주세요"):f("* 비밀번호를 다시 확인해주세요"):f("* 이메일을 확인해 주세요")};return(0,t.jsx)("div",{className:v().wrap,children:(0,t.jsxs)("div",{className:v().inner,children:[(0,t.jsxs)("h1",{children:["JOOTONG",(0,t.jsx)("button",{className:v().cancel,onClick:()=>{n(!1)}})]}),(0,t.jsxs)("div",{className:v().credential,children:[(0,t.jsx)("div",{className:"".concat(v().email," ").concat(v().box),children:(0,t.jsx)("input",{ref:a,type:"text",maxLength:50,onBlur:e=>{k(e)},placeholder:"이메일@exam.com"})}),(0,t.jsx)("div",{className:"".concat(v().password," ").concat(v().box),children:m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"password",maxLength:20,onBlur:e=>{y(e)},placeholder:"비밀번호 8자리 이상"}),(0,t.jsx)("button",{className:v().password_hidden,onClick:()=>{p(!m)}})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"text",maxLength:20,onBlur:e=>{y(e)},placeholder:"비밀번호 8자리 이상"}),(0,t.jsx)("button",{className:v().password_on,onClick:()=>{p(!m)}})]})}),(0,t.jsx)("div",{className:"".concat(v().password_confirm," ").concat(v().box),children:m?(0,t.jsx)("input",{type:"password",maxLength:20,onBlur:e=>{D(e)},placeholder:"비밀번호 확인"}):(0,t.jsx)("input",{type:"text",maxLength:20,onBlur:e=>{D(e)},placeholder:"비밀번호 확인"})}),j&&(0,t.jsx)("div",{className:v().error_message,children:j})]}),(0,t.jsxs)("label",{className:v().agree_label,children:[(0,t.jsx)("input",{type:"checkbox",ref:g}),(0,t.jsx)(x(),{onClick:()=>{g.current.checked=!0},href:"/policy/service",target:"_blank",children:"[필수]이용약관 동의하기"})]}),(0,t.jsx)("button",{className:v().signup,onClick:()=>{C()},children:"가입하기"}),N&&(0,t.jsx)("div",{className:v().loading,children:(0,t.jsx)(h.Z,{})})]})})}var w=s(7641),k=s(6936),y=s.n(k);function D(e){let{setUserArea:n,setAlarm:s,privateRoomList:r,setPrivateRoomList:a,setAlertData:i}=e,l=(0,u.sJ)(d.EA),[c,_]=(0,o.useState)(!1);return l&&(0,t.jsxs)("div",{className:y().wrap,children:[(0,t.jsx)("h1",{className:y().title,children:(0,t.jsx)("span",{className:y().nickname,children:l.nickname})}),(0,t.jsx)("div",{className:y().bridge,children:(0,t.jsx)("div",{children:(0,t.jsx)(x(),{className:y().mypage,href:"/mypage",children:"마이페이지"})})}),r.length>0&&(0,t.jsx)("div",{className:y().message_list,children:r.map(e=>(0,t.jsx)("div",{}))}),c&&(0,t.jsx)("div",{className:y().loading,children:(0,t.jsx)(h.Z,{})})]})}s(2932);var C=s(5486);function A(){let e=(0,u.sJ)(d.EA),n=(0,u.Zl)(d.np),[s,r]=(0,o.useState)({isAlert:!1,message:"",confirm:(0,t.jsx)("button",{}),cancel:(0,t.jsx)("button",{})}),[a,i]=(0,o.useState)(!1),[_,g]=(0,o.useState)(!1),[m,p]=(0,o.useState)(!1),[x,h]=(0,o.useState)(!1),[f,v]=(0,o.useState)(!1),[S,b]=(0,o.useState)([]);return(0,o.useEffect)(()=>{(async function(){return await (0,c.getSession)()})().then(e=>{console.log("session?",e),e&&n(e.user)})},[]),(0,t.jsxs)(t.Fragment,{children:[(null==e?void 0:e.user_key)?(0,t.jsxs)("div",{className:l().user_status,children:[(0,t.jsxs)("span",{onClick:()=>{h(!x)},className:"".concat(f?l().alarm:""),children:[e.nickname," 님"]}),(0,t.jsx)("button",{onClick:()=>{(0,c.signOut)({callbackUrl:"".concat(window.location.origin)})},children:"로그아웃"}),x&&(0,t.jsx)(D,{setAlarm:v,setUserArea:h,privateRoomList:S,setPrivateRoomList:b,setAlertData:r})]}):(0,t.jsxs)("div",{className:l().user_status,children:[(0,t.jsx)("button",{onClick:()=>g(!0),children:"로그인"}),_&&(0,t.jsx)("aside",{children:m?(0,t.jsx)(N,{setSignupArea:p,setAlertData:r}):(0,t.jsx)(j,{setLoginArea:g,setSignupArea:p})}),a&&(0,t.jsx)(w.Z,{setAlertData:r,setSnsSignup:i})]}),s.isAlert&&(0,t.jsx)(C.Z,{props:{message:(0,t.jsx)("span",{children:s.message}),confirm:s.confirm,cancel:s.cancel}})]})}function O(){return(0,t.jsx)("div",{className:a().wrap,children:(0,t.jsxs)("div",{className:a().inner,children:[(0,t.jsx)("div",{className:a().left_area,children:(0,t.jsx)("div",{className:a().logo,children:(0,t.jsx)(x(),{href:"/",children:"JOOTONG"})})}),(0,t.jsxs)("div",{className:a().right_area,children:[(0,t.jsx)(x(),{className:a().create_room,href:"/create"}),(0,t.jsx)("div",{className:a().search,children:(0,t.jsx)(x(),{href:"/search",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 50 50",children:(0,t.jsx)("path",{d:"M 21 3 C 11.621094 3 4 10.621094 4 20 C 4 29.378906 11.621094 37 21 37 C 24.710938 37 28.140625 35.804688 30.9375 33.78125 L 44.09375 46.90625 L 46.90625 44.09375 L 33.90625 31.0625 C 36.460938 28.085938 38 24.222656 38 20 C 38 10.621094 30.378906 3 21 3 Z M 21 5 C 29.296875 5 36 11.703125 36 20 C 36 28.296875 29.296875 35 21 35 C 12.703125 35 6 28.296875 6 20 C 6 11.703125 12.703125 5 21 5 Z"})})})}),(0,t.jsx)(A,{})]})]})})}},3033:function(e,n,s){"use strict";s.d(n,{Z:function(){return i}});var t=s(5893),r=s(8097),a=s.n(r);function i(e){let{shape:n}=e;return(0,t.jsx)("div",{className:a().wrap,children:(0,t.jsxs)("div",{className:a().loading,children:[(0,t.jsx)("div",{}),(0,t.jsx)("div",{}),(0,t.jsx)("div",{})]})})}},7641:function(e,n,s){"use strict";s.d(n,{Z:function(){return _}});var t=s(5893),r=s(4634),a=s.n(r),i=s(3299),l=s(7294),c=s(1163),o=s(1664),u=s.n(o),d=s(3033);function _(e){let{setAlertData:n,setSnsSignup:s,callbackURL:r}=e,{data:o,update:_}=(0,i.useSession)(),g=(0,c.useRouter)(),m=(0,l.useRef)(!1),[p,x]=(0,l.useState)(!1),[h,j]=(0,l.useState)(""),f=function(){m.current.checked&&o?(x(!0),j(""),fetch("/api/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o.user)}).then(e=>e.json()).then(async e=>{e.status?(o.user=e.data,await _({...o,user:{...null==o?void 0:o.user}}),setUserKey(o.user.user_key),x(!1),n({isAlert:!0,message:(0,t.jsxs)("span",{children:["\uD83C\uDF89회원가입을 축하합니다!\uD83D\uDD25\uD83D\uDD25 ",(0,t.jsx)("br",{})," [기념선물지급 - 닉네임변경권] ",(0,t.jsx)("br",{})," 마이페이지에서 사용 가능합니다"]}),confirm:(0,t.jsx)("button",{onClick:()=>{r?window.opener.parentCallback({method:"mypage"}):g.push("/mypage")},children:"마이페이지"}),cancel:(0,t.jsx)("button",{onClick:()=>{r?g.push(r):(g.push("/"),s(!1),n({isAlert:!1}))},children:"확인"})})):j(e.message)})):m.current.checked||j("* 이용약관에 동의해주세요")};return(0,t.jsxs)("div",{className:a().wrap,children:[(0,t.jsxs)("div",{className:a().inner,children:[(0,t.jsxs)("div",{className:a().greeting,children:["환영합니다, ",(0,t.jsx)("span",{children:"처음 오신 회원님!"})," ",(0,t.jsx)("br",{}),"이용약관 동의 가 필요합니다!"]}),(0,t.jsxs)("div",{className:a().credential,children:["로그인 하신 SNS 이메일",(0,t.jsx)("div",{className:a().email,children:(null==o?void 0:o.user.email)?(0,t.jsx)("input",{type:"text",value:(null==o?void 0:o.user.email)||"",readOnly:!0}):(0,t.jsx)(d.Z,{})}),h&&(0,t.jsx)("div",{className:a().error_message,children:h})]}),(0,t.jsxs)("label",{className:a().agree_label,children:[(0,t.jsx)("input",{type:"checkbox",ref:m}),(0,t.jsx)(u(),{onClick:()=>{m.current.checked=!0},href:"/policy/service",target:"_blank",children:"이용약관 동의하기"})]}),o&&(0,t.jsxs)("div",{className:a().button_group,children:[(0,t.jsx)("button",{className:a().signup,onClick:()=>{f()},children:"동의 후 계속 이용하기"}),(0,t.jsx)("button",{className:a().signout,onClick:()=>{(0,i.signOut)()},children:"취소"})]})]}),p&&(0,t.jsx)("div",{className:a().loading,children:(0,t.jsx)(d.Z,{})})]})}},5486:function(e,n,s){"use strict";s.d(n,{Z:function(){return i}});var t=s(5893),r=s(4254),a=s.n(r);function i(e){let{props:n}=e;return(0,t.jsx)("div",{className:a().wrap,children:(0,t.jsxs)("div",{className:a().inner,children:[(0,t.jsx)("div",{className:a().message,children:null==n?void 0:n.message}),(0,t.jsxs)("div",{className:a().button_box,children:[null==n?void 0:n.confirm,null==n?void 0:n.cancel]})]})})}s(3299),s(7294),s(1664)},338:function(e,n,s){"use strict";s.d(n,{sD:function(){return a},sO:function(){return c},EA:function(){return r},np:function(){return l}});var t=s(4480);let r=(0,t.cn)({key:"user"+new Date().getTime(),default:{user_key:"",nickname:""}}),a=(0,t.cn)({key:"dataList"+new Date().getTime(),default:[]}),i=(0,t.cn)({key:"calendar"+new Date().getTime(),default:[]}),l=(0,t.nZ)({key:"userSelector"+new Date().getTime(),get:e=>{let{get:n}=e;return n(r)},set:(e,n)=>{let{set:s}=e;s(r,n)}}),c=(0,t.nZ)({key:"dataListSelector"+new Date().getTime(),get:e=>{let{get:n}=e;return n(a)},set:(e,n)=>{let{set:s}=e;s(a,n=n.map(e=>(e.summaryOfContent=Object.values(JSON.parse(e.content))[0],e)))}});(0,t.nZ)({key:"calendarDataListSelector"+new Date().getTime(),get:e=>{let{get:n}=e;return n(i)},set:(e,n)=>{let{set:s}=e;s(i,n=n.map(e=>(e.summaryOfContent=Object.values(JSON.parse(e.content))[0],e)))}})},7544:function(e,n,s){"use strict";s.r(n),s.d(n,{getDateDiff:function(){return r}});var t=s(2624);let r=e=>{let n=new Date((0,t.getFormatedDate)())-new Date(e),s=parseInt(n/864e5),r=parseInt(n/36e5),a=parseInt(n/6e4);return s?{type:"day",number:s,text:s+"일전"}:r?{type:"hour",number:r,text:r+"시간전"}:{number:a,text:a+"분전"}}},2624:function(e,n,s){"use strict";s.r(n),s.d(n,{getFormatedDate:function(){return t}});let t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.target?new Date(e.target):new Date,s=n.getFullYear(),t=n.getMonth()+1;t<10&&(t="0"+t);let r=n.getDate();r<10&&(r="0"+r);let a=n.getHours();a<10&&(a="0"+a);let i=n.getMinutes();i<10&&(i="0"+i);let l=n.getSeconds();switch(l<10&&(l="0"+l),e.format){case"YYYY/MM/DD":return s+"/"+t+"/"+r;case"HH:mm":return a+":"+i;case"HH":return a;case"YYYY, MM, DD":return s+","+t+","+r;case"YYYYMMDD":return s+t+r;case"YYYY-MM-DD":return s+"-"+t+"-"+r;default:return s+"/"+t+"/"+r+" "+a+":"+i+":"+l}}},8634:function(e,n,s){"use strict";s.r(n),s.d(n,{getToday:function(){return t}});let t=()=>{let e=new Date,n=e.getTime()+6e4*e.getTimezoneOffset(),s=new Date(n+324e5);return s}},2932:function(e,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0});let t=s(8634),r=s(2624),a=s(7544);e.exports={getToday:t.getToday,getFormatedDate:r.getFormatedDate,getDateDiff:a.getDateDiff}},5137:function(e,n,s){"use strict";s.d(n,{J:function(){return t}});let t=/^[a-zA-Z0-9+-\_.]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/},1967:function(e,n,s){"use strict";s.d(n,{L:function(){return t}});let t=/^(?=.*[A-Za-z])(?=.*\d)[a-zA-Z\\d`~!@#$%^&*()-_=+]{8,20}$/},5512:function(e){e.exports={wrap:"Header_wrap__kcyi3",inner:"Header_inner__JQGFI",left_area:"Header_left_area__TPwow",logo:"Header_logo__tL_od",right_area:"Header_right_area___vjGx",create_room:"Header_create_room__gzEkv",search:"Header_search__y8rvy"}},8097:function(e){e.exports={wrap:"Loading_wrap__gYMmd",loading:"Loading_loading__3R80z"}},6502:function(e){e.exports={wrap:"Signin_wrap__vQbEq",inner:"Signin_inner__9LdS5",title:"Signin_title__vGdV4",credential:"Signin_credential__GImb_",email:"Signin_email__SlYWA",login:"Signin_login__LBElf",error_message:"Signin_error_message__u_BWj",util_box:"Signin_util_box__jqarS",agree_label:"Signin_agree_label__CrOMC",signup:"Signin_signup__BsVBX",forgot_password:"Signin_forgot_password__obQ_F",sns_login:"Signin_sns_login__NY9nD",sns_list:"Signin_sns_list__PlRQ4",google_login:"Signin_google_login__fXmmQ",naver_login:"Signin_naver_login__ENrum",kakao_login:"Signin_kakao_login__UPYXW",loading:"Signin_loading__wGoCH"}},1068:function(e){e.exports={wrap:"Signup_wrap__IP__H",inner:"Signup_inner__bBLc0",credential:"Signup_credential__jjaKf",box:"Signup_box__oJEfa",password_hidden:"Signup_password_hidden__tlvOm",password_on:"Signup_password_on__7zOkr",error_message:"Signup_error_message__xMy_o",agree_label:"Signup_agree_label__35npv",signup:"Signup_signup__S589I",greeting:"Signup_greeting__4Rq4q",button_wrap:"Signup_button_wrap__Gn6IJ",loading:"Signup_loading___h5fs"}},4634:function(e){e.exports={wrap:"SnsSignup_wrap__Cmy53",inner:"SnsSignup_inner__n_DVJ",greeting:"SnsSignup_greeting__wsgso",credential:"SnsSignup_credential__b8tVe",email:"SnsSignup_email__MmKIE",error_message:"SnsSignup_error_message__4KVFW",agree_label:"SnsSignup_agree_label__x1ZmA",button_group:"SnsSignup_button_group__zx9Z0",signup:"SnsSignup_signup__V5zhY",loading:"SnsSignup_loading__0ttm2"}},6936:function(e){e.exports={wrap:"UserCard_wrap__zqSK_",title:"UserCard_title__01pn8",nickname:"UserCard_nickname__v5x8I",bridge:"UserCard_bridge__modwg",mypage:"UserCard_mypage__VM155",message_list:"UserCard_message_list__AtzP9",room_title:"UserCard_room_title__HoOyn",delete:"UserCard_delete__It50s",message:"UserCard_message__VJWBF",text:"UserCard_text__yKMNV",date:"UserCard_date__DVy0d",red_dot:"UserCard_red_dot__bdnz1",loading:"UserCard_loading__sGiQS"}},9172:function(e){e.exports={user_status:"UserStatus_user_status__01gA4",alarm:"UserStatus_alarm__niXJL",my_point:"UserStatus_my_point__RRJtQ"}},4254:function(e){e.exports={wrap:"Alert_wrap__sjAzr",inner:"Alert_inner__yqBWk",message:"Alert_message__ODksr",button_box:"Alert_button_box__FJsUp"}}}]);